# DES(3)

## preview

- DES
  1. 使用64位长的密钥56位密钥+8位校验位
  2. 入口参数位Key,Data,Mode
     1. Key 64位，工作密钥
     2. Data 64位，要被加密或解密的数据(分块)
     3. Mode 工作方式 加密/解密
  3. 工作过程
     1. 初始置换IP -> 8x8的置换表
        1. ```int IP[] = { 58, 50, 42, 34, 26, 18,10,2,
			 60, 52, 44, 36, 28, 20, 12, 4,
			 62, 54, 46, 38, 30, 22, 14, 6,
			 64, 56, 48, 40, 32, 24, 16, 8,
			 57, 49, 41, 33, 25, 17, 9,  1,
			 59, 51, 43, 35, 27, 19, 11, 3,
			 61, 53, 45, 37, 29, 21, 13, 5,
			 63, 55, 47, 39, 31, 23, 15, 7 };```
             根据表中的规定，将输入的64位明文重新排序，即将第58位放到第1位，以此类推，初始置换后得到的是一个64位的输出

     2. 子密钥Ki的获取
        1. 根据密钥置换表PC-1 将64位变成56位密钥(去掉奇偶校验位)
        2. 将PC-1置换得到的56位密钥，分为前28位C0和后28位D0，分别对它们进行循环左移，C0左移得到C1，D0左移得到D1
        3. 将C1和D1合并成56位，然后通过PC-2表进行压缩置换，得到这一轮的48位的子密钥K1
        4. 然后对C1和D1进行左移和压缩置换，获取下一轮的子密钥...一共进行16轮，得到16个48位的子密钥
        5. 表PC-1 ```int PC_1[] = {57, 49, 41, 33, 25, 17, 9,
			   1, 58, 50, 42, 34, 26, 18,
			  10,  2, 59, 51, 43, 35, 27,
			  19, 11,  3, 60, 52, 44, 36,
			  63, 55, 47, 39, 31, 23, 15,
			   7, 62, 54, 46, 38, 30, 22,
			  14,  6, 61, 53, 45, 37, 29,
			  21, 13,  5, 28, 20, 12,  4}; ```
              密钥置换表，将64位密钥变成56位
        6. 表PC-2  ```int PC_2[] = {14, 17, 11, 24,  1,  5,
			   3, 28, 15,  6, 21, 10,
			  23, 19, 12,  4, 26,  8,
			  16,  7, 27, 20, 13,  2,
			  41, 52, 31, 37, 47, 55,
			  30, 40, 51, 45, 33, 48,
			  44, 49, 39, 56, 34, 53,
			  46, 42, 50, 36, 29, 32};```
              压缩置换，将56位密钥压缩成48位子密钥
        7. 每轮左移的位数 `int shiftBits[] = {1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1};` ->一共16轮

     3. 密码函数f
        1. 密码函数f(R,K)接受两个输入:32位的数据和48位的子密钥
        2. 通过表E进行扩展置换，将输入的32位数据扩展位48位
        3. 将扩展后的48位数据与48位的子密钥进行异或运算
        4. 将异或得到的48位数据分成8个6位的块，每一块同对应的一个S表产生一个4位的输出
        5. E表```// 扩展置换表，将 32位 扩展至 48位
int E[] = {32,  1,  2,  3,  4,  5,
		    4,  5,  6,  7,  8,  9,
		    8,  9, 10, 11, 12, 13,
		   12, 13, 14, 15, 16, 17,
		   16, 17, 18, 19, 20, 21,
		   20, 21, 22, 23, 24, 25,
		   24, 25, 26, 27, 28, 29,
		   28, 29, 30, 31, 32,  1};```
         
     4. 尾置换IP-1
        1. 合并L16和R16得到一个64位数据，然后通过尾置换后得到64位的密文
  1. 
- DES(3)